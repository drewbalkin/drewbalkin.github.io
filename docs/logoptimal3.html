<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>blog - Log Optimal Numeraire in Incomplete Markets</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./KellyOptimalMarketCycles.html" rel="" target="">
 <span class="menu-text">Valuation-Based Kelly Optimal Portfolios</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-log-optimal-portfolio-and-option-pricing" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Log Optimal Portfolio and Option Pricing</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-log-optimal-portfolio-and-option-pricing">    
        <li>
    <a class="dropdown-item" href="./logoptimal1.html" rel="" target="">
 <span class="dropdown-text">Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./logoptimal2.html" rel="" target="">
 <span class="dropdown-text">Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./logoptimal3.html" rel="" target="">
 <span class="dropdown-text">Part 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#indifference-pricing-for-all-crra-utilities" id="toc-indifference-pricing-for-all-crra-utilities" class="nav-link active" data-scroll-target="#indifference-pricing-for-all-crra-utilities">Indifference Pricing for all CRRA Utilities</a></li>
  <li><a href="#the-big-result" id="toc-the-big-result" class="nav-link" data-scroll-target="#the-big-result">The Big Result</a>
  <ul class="collapse">
  <li><a href="#the-computation" id="toc-the-computation" class="nav-link" data-scroll-target="#the-computation">The computation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Log Optimal Numeraire in Incomplete Markets</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>What we will now show is a very interesting result regarding the pricing under the log-optimal numeraire. So far, we have shown for a very general model, that the pricing</p>
<p><span class="math display">\[
\Pi(t;X) = \mathbb{E}^\mathbb{P} \left[ \frac{X}{V^{\pi^*}_T/V^{\pi^*}_t} \Bigg| \mathcal{F}_t \right]
\]</span> holds for all attainable claims <span class="math inline">\(X\)</span> where <span class="math inline">\(\pi^*\)</span> is the log-optimal portfolio process and <span class="math inline">\(V^{\pi^*}\)</span> its corresponding portfolio value. This exciting results means that the naive pricing can be done under the physical measure <span class="math inline">\(\mathbb{P}\)</span> as long as we were denoting everything to be in the “right” units of “currency” (or numeraire) – which happens to be the log-optimal portfolio.</p>
<p>Although an exciting result, there are two main problems this faces for practical implementation. The first is that it is actually hard to achieve the growth optimal portfolio as one would have to know the local rates of mean return, volatilities (across all differing possible sources of noise), and money market rate – <span class="math inline">\(\mu_t\)</span>, <span class="math inline">\(\sigma_t\)</span>, <span class="math inline">\(r_t\)</span> at each time. Although these values are themselves random, the model we consider (a generalization of Black-Scholes, local volatility, stochastic volatility, and much else) still assumes that at time <span class="math inline">\(t\)</span> we know what those values are at that instant (although we don’t know the resulting shocks due to the noise). Specifying the “ground truth” (random) model is very, very hard in reality!</p>
<p>We will not address this claim. Instead we will deal with a secondary problem. What we have shown so far is a pricing for attainable claims. For unattainable claims (ones we cannot hedge), we may still find a derivative (long or short) compelling based on the price. Thus although one cannot hedge the option, one can still assign their personal value to the option. If the option (at the observed price) adds value to their portfolio, then the investor will buy the option. If not, they will sell the option.</p>
<p>Using utility theory, it is very easy to understand when the investor gains from buying or selling the option. Suppose <span class="math inline">\(\pi\)</span> is the optimal portfolio (among presently traded securities) for an investor with utility function <span class="math inline">\(U\)</span>. All of a sudden, an option <span class="math inline">\(\chi\)</span> comes on the market. The option will payout <span class="math inline">\(\chi_T\)</span> at time <span class="math inline">\(T\)</span> and can be bought/sold for <span class="math inline">\(\chi_0\)</span>. Without loss of generality, assume <span class="math inline">\(V^\pi_0 = 1\)</span>. The investor will be interested (in a small amount) of the option if the initial price <span class="math inline">\(\chi_0\)</span> is such that their expected utility increases by of their current (utility optimal) portfolio for the option. If the option price is such that their expected utility decreases by adding a small amount of option, then we can show the investor would be interested in the short option position. Thus, we can price (an infinitely small amount of option) for the investor as the price such that they are indifferent to adding a small amount of option to their portfolio.</p>
<section id="indifference-pricing-for-all-crra-utilities" class="level1">
<h1>Indifference Pricing for all CRRA Utilities</h1>
<p>We will now compute the marginal utility indifference price for all CRRA investors. This means that an investor has the utility of the form</p>
<p><span class="math display">\[U(x) = \gamma x^ \gamma\]</span></p>
<p>for some <span class="math inline">\(\gamma &lt; 1\)</span>. This is an arbitrary CRRA utility function. While this seems restrictive, this is a general utility function for the class of investor’s who decide on lotteries based purely on return outcomes and not absolute wealth levels. In other words, a CRRA utility investor would have the exact same strategy (dependent entirely on the future distribution of returns) if managing $1000, $ 1M or $1B.</p>
<p>Assume that an investor currently has an optimal portfolio strategy for their utility function. This gives wealth process <span class="math inline">\(V^{\pi_\gamma}_T\)</span>. WLOG assume <span class="math inline">\(V^{\pi_\gamma}_0 = 1\)</span>.</p>
<p>Now consider a claim with payout at time <span class="math inline">\(T\)</span>, <span class="math inline">\(\chi_T\)</span>. We denote its value (to investor with utility indexed by <span class="math inline">\(\gamma\)</span>) at time <span class="math inline">\(0\)</span> by <span class="math inline">\(\chi_0(\gamma)\)</span>.</p>
<p>Assuming the investor now allocates <span class="math inline">\(\epsilon\)</span> of their wealth to <span class="math inline">\(\chi\)</span> and <span class="math inline">\((1-\epsilon)\)</span> to their original (<span class="math inline">\(\gamma\)</span> - utility optimal) strategy, then the investor will be indifferent to adding the option if</p>
<p><span class="math display">\[\frac{d}{d\epsilon} \Bigg|_{\epsilon = 0} \mathbb{E} \left[ U\left((1-\epsilon)V^{\pi_\gamma}_T + \epsilon \frac{\chi_T}{\chi_0}\right)\right] = 0.\]</span></p>
<p>What this means is that the investor does not gain any utility by adding/ removing <span class="math inline">\(\chi\)</span> to their portfolio. In otherwords, they are indifferent to buying or selling the option. What we notice is that whether the above will hold or not depends on the initial price of the option <span class="math inline">\(\chi_0\)</span>. Thus we call <span class="math inline">\(\chi_0(\gamma)\)</span> to be the marginal utility indifference price of the option for investor with risk tolerance <span class="math inline">\(\gamma\)</span>. It turns out we can solve for <span class="math inline">\(\chi_0(\gamma)\)</span> by taking the derivative and using the linearity of the expectation. We actually get that</p>
<p>This corresponds to:</p>
<p><span class="math display">\[\chi_0(\gamma) = \frac{\mathbb{E} \left[ U'(V^{\pi_\gamma}_T) \chi_T \right]}{\mathbb{E} \left[ U'(V^{\pi_\gamma}_T) V^{\pi_\gamma}_T\right]},\]</span></p>
<p>where the expectation is under <span class="math inline">\(\mathbb{P}\)</span>. We can write this very suggestively as:</p>
<p><span class="math display">\[
\chi_0(\gamma) = \mathbb{E}^\mathbb{P}[ m_T(\gamma) \chi_T ]
\]</span> by taking <span class="math display">\[m_T(\gamma) =  \frac{U'(V^{\pi_\gamma}_T)}{\mathbb{E} \left[ U'(V^{\pi_\gamma}_T) V^{\pi_\gamma}_T \right]}.\]</span></p>
<p>Thus we have found the natural stochastic discount factor for an investor with a given utility function and now anyone can go home and price options for themselves (assuming they know their utility and the ground truth distribution on future returns)! In fact, we never used CRRA utility and we can just go home knowing what to do for any utility. But actually, we are just getting started.</p>
<p>Note we have for investor with CRRA utility and risk tolerance parameter <span class="math inline">\(\gamma\)</span> that</p>
<p><span class="math display">\[\chi_0(\gamma) = \frac{\mathbb{E}^\mathbb{P} \left[ U'(V^{\pi_\gamma}_T) \chi_T \right]}{\mathbb{E}^\mathbb{P} \left[ U'(V^{\pi_\gamma}_T) V^{\pi_\gamma}_T\right]}.\]</span></p>
<p>We know that if the investor has the log utility <span class="math inline">\(\gamma = 0\)</span>, then we will have <span class="math inline">\(U'(V^{\pi^*}_T) = \frac{1}{V^{\pi^*}_T}\)</span> so we get the result that we previously knew:</p>
<p><span class="math display">\[
\chi_0(0) = \mathbb{E}^\mathbb{P} \left[ \frac{\chi_T}{V^{\pi^*}_T)} \right].\]</span></p>
<p>That’s exciting!!! But wait… not really. Not everyone is a log utility investor as they could have different risk preferences. In reality, not everyone is a CRRA investor either, but the following result is so satisfying, that maybe we can temporarily allow for it.</p>
</section>
<section id="the-big-result" class="level1">
<h1>The Big Result</h1>
<p>We haven’t yet used the CRRA utility property. What we will show is that for all <span class="math inline">\(\gamma &lt; 1\)</span>, that is for all CRRA risk preferences, we have that <span class="math inline">\(\chi_0(\gamma) = \chi_0(0)\)</span>, that is the indifference price is the same for all assets. Because of this, it gives that for all CRRA investors (even with different risk preferences), their indifference price is given by:</p>
<p><span class="math display">\[\chi_0(\gamma) = \mathbb{E} \left[\frac{\chi_T}{V^{\pi^*}_T} \right],\]</span></p>
<p>where <span class="math inline">\(V^{\pi^*}_T\)</span> is the value process at time <span class="math inline">\(T\)</span> for the log-optimal portfolio– the result we had before for attainable claims!!!</p>
<p>Now, one big caveat is that this is the price for an infinitesimal amount of derivative. The desired price the investor demands may differ if they already and a substantial position in the derivative security. But still, pretty unbelievable result!</p>
<section id="the-computation" class="level2">
<h2 class="anchored" data-anchor-id="the-computation">The computation</h2>
<p>As before, we assume the following model for <span class="math inline">\(I\)</span> risk assets driven by <span class="math inline">\(J\)</span> noises so as to get:</p>
<p><span class="math display">\[ \frac{dS^i_t}{S^i_t} = \mu^i_t dt + \sum_{j=J}^m \sigma^{ij}_t dW^j_t\]</span></p>
<p>with portfolio processes then given by</p>
<p><span class="math display">\[\frac{dV^\pi_t}{V^\pi_t} = \sum_{i=1}^I \pi^i_t \frac{dS^i_t}{S^i_t}.\]</span> Notice how we are temporarily ignoring the money-market allocation and rate <span class="math inline">\(r_t\)</span>. Actually, we can assume that we are (temporarily) in units of the cash-account numeraire i.e.&nbsp;everything is priced in units of <span class="math inline">\(B_t\)</span>. This can be easily worked out. The main thing is that the asset local mean returns are understood now as <span class="math inline">\(\mu^i_t - r_t\)</span> (since they are discounted by the bank account). Also, <span class="math inline">\((\pi^i_t)\)</span> need not add up to <span class="math inline">\(1\)</span> as the remaining amount is taken to be borrowings. If it makes one feel better, one can adjust the model to be the same one from <a href="./logoptimal2.html">part 2</a> and carry out the future computations in terms of the model in terms of units of currency and not units of <span class="math inline">\(B_t\)</span>.</p>
<p>Anyway, with this out of the way, we proceed by computing the optimal portfolios for investors with <span class="math inline">\(\gamma\)</span> risk preference parameter. Actually, we will show that like the log-utility maximization example from <a href="./logoptimal1.html">part 1</a>, the case of power utility can also be optimized in a very similar fashion in a way that ignores HJB equations!</p>
<p>We compute:</p>
<p><span class="math display">\[d \log((V^{\pi_\gamma}_t)^\gamma) = \gamma d \log(V^{\pi_\gamma}_t) =  \gamma\frac{dV^{\pi_\gamma}_t}{V^{\pi_\gamma}_t} - \frac{1}{2} \gamma \left(\frac{dV^{\pi_\gamma}_t}{V^{\pi_\gamma}_t} \right)^2.\]</span></p>
<p>This gives</p>
<p><span class="math display">\[ (V^{\pi_\gamma}_T)^\gamma = \exp \left[ \int_0^T \gamma \left(  \pi_t^T \mu_t -   \frac{1}{2} \pi_t^T \sigma_t \sigma_t^T \pi_t \right) dt + \int_0^T \gamma \pi_t^T \sigma_t d\vec{W}_t \right] .\]</span></p>
<p>So</p>
<p><span class="math display">\[\mathbb{E}[U(V^{\pi_\gamma}_T)] = \mathbb{E}[\gamma (V^{\pi_\gamma}_T)^\gamma] = \gamma \mathbb{E} \exp \left[ \int_0^T  \left(  \gamma \pi_t^T \mu_t -   (\frac{1}{2}\gamma - \frac{1}{2}\gamma^2)  \pi_t^T \sigma_t \sigma_t^T \pi_t \right) dt \right].\]</span></p>
<p>So if <span class="math inline">\(Ker(\sigma_t\sigma_t^T) = \varnothing\)</span> then, we can optimize the integrand pointwise and the optimal portfolio occurs at <span class="math display">\[ \pi_t = \frac{1}{1-\gamma}(\sigma_t \sigma_t^T)^{-1} \mu_t\]</span>. To see why optimizing the integrand pointwise holds, note that:</p>
<p><span class="math display">\[f(\pi_t(\omega) , \omega, t) =  \gamma \pi_t(\omega)^T \mu_t(\omega) -   (\frac{1}{2}\gamma - \frac{1}{2}\gamma^2)  \pi_t(\omega)^T \sigma_t(\omega) \sigma_t^T(\omega) \pi_t(\omega).\]</span></p>
<p>Note that <span class="math inline">\(\gamma &lt; 1\)</span> and <span class="math inline">\(\sigma \sigma^T\)</span> is uniformly strictly positive definite by assumption, so by quadratic optimization, we have that <span class="math inline">\(\pi^*_t(\omega) = \frac{1}{1-\gamma}(\sigma_t \sigma_t^T)^{-1} \mu_t\)</span> is such that:</p>
<p><span class="math display">\[f(\pi_t(\omega),\omega,t) \leq f(\pi^*_t(\omega),\omega,t), \quad \forall (t, \omega).\]</span> Hence</p>
<p><span class="math display">\[\mathbb{E} \left[ e^{\int_0^T f (\pi_t(\omega),\omega,t) dt} \right] \leq \mathbb{E} \left[ e^{\int_0^T f(\pi^*_t(\omega),\omega,t) dt} \right].\]</span></p>
<p>In reality, <span class="math inline">\(Ker(\sigma_t\sigma_t^T) = \varnothing\)</span> which corresponds to absence of arbitrage in the underlying assets, and thus we have the unique portfolio strategy for each given risk preference. With everything somewhat explicit, we can easily compute the indifference price</p>
<p><span class="math display">\[\chi_0 = \frac{\mathbb{E} \left[ U'(V^{\pi_\gamma}_T) \chi_T \right]}{\mathbb{E} \left[ U'(V^{\pi_\gamma}_T) V^{\pi_\gamma}_T\right]}\]</span></p>
<p>and show it is the same for each <span class="math inline">\(\gamma\)</span>.</p>
<p>First, notice the CRRA utility satisfies <span class="math inline">\(U'(V^{\pi_\gamma}_T) = \gamma \frac{U(V^{\pi_\gamma}_T)}{V^{\pi_\gamma}_T}\)</span>. This allows us to write:</p>
<p><span class="math display">\[\chi_0 = \frac{\mathbb{E} \left[ U(V^{\pi_\gamma}_T) \frac{\chi_T}{V^{\pi_\gamma}_T} \right]}{\mathbb{E} [ U(V^{\pi_\gamma}_T)]} = \mathbb{E} \left[ \frac{U(V^{\pi_\gamma}_T)}{\mathbb{E} [ U(V^{\pi_\gamma}_T)]} \frac{\chi_T}{V^{\pi_\gamma}_T} \right].\]</span></p>
<p>First</p>
<p><span class="math display">\[ V^{\pi_\gamma}_T = \exp \left[ \int_0^T\left(  \pi_t^T \mu_t -   \frac{1}{2} \pi_t^T \sigma_t \sigma_t^T \pi_t \right) dt + \int_0^T  \pi_t^T \sigma_t d\vec{W}_t \right] \]</span></p>
<p>where <span class="math inline">\(\pi_t = \frac{1}{1-\gamma}(\sigma_t \sigma_t^T)^{-1} \mu_t\)</span>. So we have</p>
<p><span class="math display">\[ V^{\pi_\gamma}_T = \exp \left[ \int_0^T \frac{\frac{1}{2} - \gamma}{(1-\gamma)^2} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \mu_t dt + \int_0^T \frac{1}{1-\gamma} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \sigma_t d\vec{W}_t  \right] .\]</span></p>
<p>Next</p>
<p><span class="math display">\[ (V^{\pi_\gamma}_T)^\gamma = \exp \left[ \int_0^T \gamma \frac{\frac{1}{2} - \gamma}{(1-\gamma)^2} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \mu_t dt + \int_0^T \frac{\gamma}{1-\gamma} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \sigma_t d\vec{W}_t  \right] .\]</span></p>
<p>Therefore</p>
<p><span class="math display">\[\frac{U(V^{\pi_\gamma}_T)}{\mathbb{E} [ U(V^{\pi_\gamma}_T)]} = \exp \left[ \int_0^T -\frac{1}{2}\left(\frac{\gamma}{1-\gamma} \right)^2 \mu_t^T (\sigma_t \sigma_t^T)^{-1} \mu_t dt + \int_0^T \frac{\gamma}{1-\gamma} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \sigma_t d\vec{W}_t  \right]\]</span></p>
<p>Thus</p>
<p><span class="math display">\[ \frac{U(V^{\pi_\gamma}_T)}{\mathbb{E} [ U(V^{\pi_\gamma}_T)]} \frac{1}{V^{\pi_\gamma}_T}   =   \exp \left[ \int_0^T \frac{-1}{2} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \mu_t dt - \int_0^T \mu_t^T (\sigma_t \sigma_t^T)^{-1} \sigma_t d\vec{W}_t  \right]\]</span></p>
<p>and hence the indifference price is then:</p>
<p><span class="math display">\[\chi_0 = \mathbb{E} \left[ \frac{U(V^{\pi_\gamma}_T)}{\mathbb{E} [ U(V^{\pi_\gamma}_T)]} \frac{\chi_T}{V^{\pi_\gamma}_T} \right] = \mathbb{E} \left[ \frac{\chi_T}{\exp \left[ \int_0^T \frac{1}{2} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \mu_t dt + \int_0^T \mu_t^T (\sigma_t \sigma_t^T)^{-1} \sigma_t d\vec{W}_t  \right]}  \right].\]</span></p>
<p>Lastly note that the log-optimal portfolio corresponds to</p>
<p><span class="math display">\[\pi^*_t = (\sigma_t \sigma_t^T)^{-1} \mu_t\]</span> and its corresponding portfolio process is <span class="math inline">\(V^{\pi^*}_T = \exp \left[ \int_0^T \frac{1}{2} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \mu_t dt + \int_0^T \mu_t^T (\sigma_t \sigma_t^T)^{-1} \sigma_t d\vec{W}_t \right]\)</span>.</p>
<p>Thus each CRRA investor has the indifference price:</p>
<p><span class="math display">\[\chi_0 = \mathbb{E} \left[ \frac{\chi_T}{\exp \left[ \int_0^T \frac{1}{2} \mu_t^T (\sigma_t \sigma_t^T)^{-1} \mu_t dt + \int_0^T \mu_t^T (\sigma_t \sigma_t^T)^{-1} \sigma_t d\vec{W}_t  \right]}  \right] = \mathbb{E} \left[ \frac{\chi_T}{V^{\pi^*}_T} \right],\]</span></p>
<p>EVEN in the case of non-attainable claims.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>